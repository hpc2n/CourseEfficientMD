* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) v1.8 on Jun, 10. 2017. JOBID=1497111557
* INPUT GENERATION
* 

DIMENS CHSIZE 3000000 MAXRES 3000000

! Read topology and parameter files
stream toppar.str

! Read the system information
stream step3_pbcsetup.str

! Read PSF
open read unit 10 card name step3_pbcsetup.psf
read psf  unit 10 card xplor

! Read Coordinate
open read unit 10 card name step3_pbcsetup.crd
read coor unit 10 card

system "cp */*.rtf toppar/"
system "cp */*.prm toppar/"

! for NAMD restraints
system "mkdir -p namd/restraints"

define PROT sele ( segid PROA ) end
define CARB sele none end
define HETE sele none end

define BB   sele ( ( type C   .or. type O   .or. type N   .or. type CA  .or. -
                     type P   .or. type O1P .or. type O2P .or. type O5' .or. -
                     type C5' .or. type C4' .or. type C3' .or. type O3' ) .and. PROT ) .or. -
                 ( ( type C+ .or. ( type O5 .and. .bonded. type C1 ) .or. ( type O6 .and. .bonded. type C2 ) ) .and. CARB ) .or. -
                 ( .not. hydrogen .and. HETE ) end
define SC   sele .not. BB .and. .not. hydrogen .and. ( PROT .or. CARB ) end

scalar wmain set 0 sele all end
scalar wmain set 1 sele BB end
write coor pdb name namd/restraints/bb_rmsd.ref

scalar wmain set 0 sele all end
scalar wmain set 1 sele SC end
write coor pdb name namd/restraints/sc_rmsd.ref
system "mkdir -p namd/toppar"
system "python convert_par2namd.py toppar.str toppar/"

! GROMACS
stream step3_input.gmx.str

! AMBER
stream step3_input.amber.str

! OpenMM
stream step3_input.omm.str

! LAMMPS
stream step3_input.lammps.str

stop